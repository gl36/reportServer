(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{1250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1048);var r,o=n(442);var u=new((r=o)&&r.__esModule?r:{default:r}).default,s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"get",value:function(){}}],[{key:"getBaseUrl",value:function(){return window.getServerUrl()}},{key:"post",value:function(t,n){if(null==u.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t||""==u.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t)return window.location.href="#login",new Promise(function(e,t){});var a=e.getBaseUrl()+t,r={method:"POST",headers:{credentials:JSON.stringify(u.getStorage("userInfo")||"")},body:n};return fetch(a,r).then(function(e){return e.json()}).catch(function(e){return e.json()})}}]),e}();t.default=s},1265:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1250),u=(a=o)&&a.__esModule?a:{default:a};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getRoleList",value:function(e){return u.default.post("/reportServer/role/getRoleList",JSON.stringify(e))}},{key:"getRoleInfo",value:function(e){return u.default.post("/reportServer/role/getRoleInfoById",e)}},{key:"saveRoleInfo",value:function(e){return"null"==e._id?u.default.post("/reportServer/role/addRole",JSON.stringify(e)):u.default.post("/reportServer/role/updateRole",JSON.stringify(e))}},{key:"delRole",value:function(e){return u.default.post("/reportServer/role/deleteRole",e)}},{key:"getUserListByRoleId",value:function(e){return u.default.post("/reportServer/role/getUserListByRoleId",e)}},{key:"saveUserId",value:function(e){return u.default.post("/reportServer/role/saveOrupdateUserId",JSON.stringify(e))}}]),e}();t.default=s},1277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(1042)),r=g(n(1047)),o=g(n(90)),u=g(n(44)),s=g(n(1053)),i=g(n(138)),l=g(n(213)),c=g(n(1043)),d=g(n(1207)),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1041),n(1046),n(289),n(157),n(1052),n(447),n(449),n(443),n(1200);var h=g(n(1)),p=g(n(1265)),y=g(n(1298)),v=g(n(448));function g(e){return e&&e.__esModule?e:{default:e}}function m(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var S=d.default.TreeNode,k=new p.default,b=new y.default,C=c.default.Search,K=l.default.TabPane,N=(i.default.Option,function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onExpand=function(e){n.setState({expandedKeys:e,autoExpandParent:!1})},n.onCheck=function(e,t){var a=e.checked,r=n.state.treeData;n.node=null,n.parentNodes=[];var o=n.getNode(r,t.node.props.eventKey),u=Array.from(new Set([].concat(m(a),m(o))));if(null!=t.node.props.children&&"undefined"!=t.node.props.children){var s=t.node.props.children,i=t.node.props.checked;n.showExcelRuleTreeNodeReact(i,s,u)}else n.setState({checkedKeys:u},function(){})},n.renderTreeNodes=function(e){return e.map(function(e){return e.children?h.default.createElement(S,{title:e.title,key:e.key,dataRef:e},n.renderTreeNodes(e.children)):h.default.createElement(S,e)})},n.onChangeTab=function(e){n.setState({activeKey:e,treeData:[]},function(){var t=this.state.roleName,n=this.state.roleId;""!=n&&this.selectedOnchage(n,t,e,"true")})};return n.parentNodes=[],n.node=null,n.newTabIndex=0,n.state={roleId:n.props.match.params.roleId,list:[],pageNum:1,perPage:10,listType:"list",expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],tabPosition:"top",treeData:[],activeKey:"select",roleName:"",panes:[]},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,h.default.Component),f(t,[{key:"componentDidMount",value:function(){this.loadRoleList(),null!=this.state.roleId&&""!=this.state.roleId&&"null"!=this.state.roleId&&this.selectedOnchage(this.state.roleId,"","","")}},{key:"loadRoleList",value:function(){var e=this,t={};t.pageNum=this.state.pageNum,t.perPage=this.state.perPage,"search"===this.state.listType&&(t.roleName=this.state.roleName),k.getRoleList(t).then(function(t){e.setState(t)},function(t){e.setState({list:[]})})}},{key:"onValueChange",value:function(e){e.target.name;var t=e.target.value.trim();this.setState({roleName:t})}},{key:"onSearch",value:function(){var e=this;this.setState({pageNum:1,listType:"search"},function(){e.loadRoleList()})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadRoleList()})}},{key:"showExcelRuleTreeNodeReact",value:function(e,t,n){var a=this;e?t.map(function(t,r){for(var o=0;o<n.length;o++)n[o]==t.key&&(n.splice(o,1),o--);if(null!=t.props.children&&"undefined"!=t.props.children){var u=t.props.children;a.showExcelRuleTreeNodeReact(e,u,n)}}):t.map(function(t,r){if(n.push(t.key),null!=t.props.children&&"undefined"!=t.props.children){var o=t.props.children;a.showExcelRuleTreeNodeReact(e,o,n)}}),this.setState({checkedKeys:n},function(){})}},{key:"getNode",value:function(e,t){for(var n=0;n<e.length&&!this.node;n++){var a=e[n];if(a&&a.key){if(a.key==t){this.node=a;break}a.children&&(this.parentNodes.push(a.key),this.getNode(a.children,t))}}return n==e.length&&this.parentNodes.splice(this.parentNodes.length-1,1),this.parentNodes}},{key:"selectedOnchage",value:function(e,t,n,a){this.setState({roleId:e,roleName:t,expandedKeys:[],checkedKeys:[]},function(){var t=this,r="select";"select"==(r=""!=n?n:this.state.activeKey)?this.state.treeData.length>0&&""==a?b.getAuthListByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getSelectClassTree().then(function(n){500!=n.status&&(t.setState({treeData:n}),b.getAuthListByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"template"==r?this.state.treeData.length>0&&""==a?b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getDirectory().then(function(n){500!=n.status&&(t.setState({treeData:n}),b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"function"==r?this.state.treeData.length>0&&""==a?b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getFunctionClass().then(function(n){500!=n.status&&(t.setState({treeData:n}),b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"func"==r?this.state.treeData.length>0&&""==a?b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getFunRuleList("excel").then(function(n){500!=n.status&&(t.setState({treeData:n}),b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"webFunc"==r?this.state.treeData.length>0&&""==a?b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getFunRuleList("reactWeb").then(function(n){500!=n.status&&(t.setState({treeData:n}),b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"table"==r?this.state.treeData.length>0&&""==a?b.getAuthByConditionsTable(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getAllAuthTypeList().then(function(n){"3000"!=n.resultCode&&(t.setState({treeData:n.data}),b.getAuthByConditionsTable(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"cube"==r?this.state.treeData.length>0&&""==a?b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getAllCube().then(function(n){500!=n.status&&(t.setState({treeData:n.data}),b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})):"dashboard"==r&&(this.state.treeData.length>0&&""==a?b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}):(this.setState({treeData:[]}),b.getAllDashBoard().then(function(n){500!=n.status&&(t.setState({treeData:n.data}),b.getAuthByConditions(e,r).then(function(e){var n=[];"3000"!=e.resultCode&&(e.map(function(e,t){n.push(e.funcId)}),t.setState({expandedKeys:n,checkedKeys:n}))}))})))})}},{key:"saveSelectObject",value:function(){var e=[this.state.roleId,this.state.activeKey,this.state.checkedKeys];b.saveAuthRules(e).then(function(e){s.default.success("保存成功")})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=t});var t=this.state.list,n=[{dataIndex:"roleName",key:"roleName",render:function(t,n){return h.default.createElement("a",{href:"javascript:;",onClick:function(){return e.selectedOnchage(n.roleId,n.roleName,"","")}},t)}}],s=h.default.createElement("div",null,h.default.createElement(u.default,{type:"primary",onClick:function(){return e.saveSelectObject()}},"保存"),h.default.createElement(d.default,{checkable:!0,onExpand:this.onExpand,expandedKeys:this.state.expandedKeys,autoExpandParent:this.state.autoExpandParent,onCheck:this.onCheck,checkedKeys:this.state.checkedKeys,selectedKeys:this.state.selectedKeys,checkStrictly:!0},this.renderTreeNodes(this.state.treeData)));return h.default.createElement("div",{id:"page-wrapper"},h.default.createElement(a.default,{title:"角色列表",style:{float:"left",width:"20%"}},h.default.createElement(o.default,null,h.default.createElement(C,{style:{maxWidth:190,marginBottom:"10px",marginLeft:"-20px",marginRight:"-30px",border:"0"},placeholder:""==this.state.roleName?"请输入...":this.state.roleName,enterButton:"查询",onSearch:function(t){return e.onSearch(t)},onChange:function(t){return e.onValueChange(t)},value:this.state.roleName})),h.default.createElement(r.default,{dataSource:t,columns:n,pagination:!1,showHeader:!1,style:{marginLeft:"-30px",marginRight:"-30px",border:"0"}}),h.default.createElement(v.default,{current:this.state.pageNum,total:this.state.total,onChange:function(t){return e.onPageNumChange(t)}})),h.default.createElement(a.default,{title:"权限列表",style:{float:"left",width:"80%"}},h.default.createElement(l.default,{defaultActiveKey:"select",onChange:this.onChangeTab,tabPosition:this.state.tabPosition},h.default.createElement(K,{tab:"查询",key:"select"},s),h.default.createElement(K,{tab:"函数",key:"function"},s),h.default.createElement(K,{tab:"多维分析",key:"cube"},s),h.default.createElement(K,{tab:"仪表盘",key:"dashboard"},s),h.default.createElement(K,{tab:"模板",key:"template"},s),h.default.createElement(K,{tab:"功能",key:"func"},s),h.default.createElement(K,{tab:"网站菜单",key:"webFunc"},s),h.default.createElement(K,{tab:"数据权限",key:"table"},s))))}}]),t}());t.default=N},1298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1250),u=(a=o)&&a.__esModule?a:{default:a};var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getSelectClassTree",value:function(){return u.default.post("reportServer/query/getQueryClassTree",{})}},{key:"getAuthListByConditions",value:function(e,t){var n=[e,t];return u.default.post("/reportServer/auth/getAuthListByConditions",JSON.stringify(n))}},{key:"getFunctionClass",value:function(){return u.default.post("/reportServer/function1/getFunctionClass",{})}},{key:"getAuthByConditions",value:function(e,t){var n=[e,t];return u.default.post("/reportServer/auth/getAuthByConditions",JSON.stringify(n))}},{key:"getAuthByConditionsTable",value:function(e,t){var n=[e,t];return u.default.post("/reportServer/auth/getAuthByConditionsTable",JSON.stringify(n))}},{key:"getDirectory",value:function(){return u.default.post("/reportServer/template/getDirectory",{})}},{key:"getFunRuleList",value:function(e){var t={type:e};return u.default.post("/reportServer/auth/getFunRuleListReact",JSON.stringify(t))}},{key:"getAllAuthTypeList",value:function(){return u.default.post("/reportServer/auth/getAllAuthTypeList",{})}},{key:"getDataList",value:function(){return u.default.post("/reportServer/auth/getDataList",{})}},{key:"getDepartmentList",value:function(){return u.default.post("/reportServer/auth/getDepartmentList",{})}},{key:"getAuthTypeListByType",value:function(e){return u.default.post("/reportServer/authType/getAuthTypeListByType",JSON.stringify({authType:e}))}},{key:"saveAuthRules",value:function(e){return u.default.post("/reportServer/auth/saveAuthRules",JSON.stringify(e))}},{key:"getAllCube",value:function(){return u.default.post("/reportServer/auth/getAllCube",{})}},{key:"getAllDashBoard",value:function(){return u.default.post("/reportServer/auth/getAllDashBoard",{})}}]),e}();t.default=s}}]);
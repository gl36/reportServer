(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1250:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(1048);var l,r=a(442);var u=new((l=r)&&l.__esModule?l:{default:l}).default,i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"get",value:function(){}}],[{key:"getBaseUrl",value:function(){return window.getServerUrl()}},{key:"post",value:function(t,a){if(null==u.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t||""==u.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t)return window.location.href="#login",new Promise(function(e,t){});var n=e.getBaseUrl()+t,l={method:"POST",headers:{credentials:JSON.stringify(u.getStorage("userInfo")||"")},body:a};return fetch(n,l).then(function(e){return e.json()}).catch(function(e){return e.json()})}}]),e}();t.default=i},1252:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(1250),u=(n=r)&&n.__esModule?n:{default:n};var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return l(e,[{key:"getDbList",value:function(){return u.default.post("reportServer/DBConnection/ListAll",{})}},{key:"getDb",value:function(e){return u.default.post("reportServer/DBConnection/GetByName",e)}},{key:"saveDb",value:function(e){if("null"==e._name){return u.default.post("reportServer/DBConnection/save",JSON.stringify(e))}return u.default.post("reportServer/DBConnection/update",JSON.stringify(e))}},{key:"deleteDb",value:function(e){return u.default.post("reportServer/DBConnection/Delete",e)}},{key:"testDb",value:function(e){return u.default.post("reportServer/DBConnection/test",JSON.stringify(e))}}]),e}();t.default=i},1389:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(1042)),l=h(a(1047)),r=h(a(120)),u=h(a(66)),i=h(a(44)),o=h(a(1053)),d=h(a(1043)),s=h(a(138)),f=h(a(1045)),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},p=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();a(1041),a(1046),a(445),a(446),a(157),a(1052),a(443),a(447),a(1044);var b=h(a(1)),m=h(a(1250)),v=h(a(1252));function h(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function E(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}a(1390);var S=f.default.Item,C=s.default.Option,x=new v.default,L=b.default.createContext(),w=f.default.create()(function(e){var t=e.form,a=(e.index,E(e,["form","index"]));return b.default.createElement(L.Provider,{value:t},b.default.createElement("tr",a))}),N=function(e){function t(){var e,a,n;y(this,t);for(var l=arguments.length,r=Array(l),u=0;u<l;u++)r[u]=arguments[u];return a=n=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),n.state={editing:!0},n.toggleEdit=function(){var e=!n.state.editing;n.setState({editing:e},function(){e&&n.input.focus()})},n.save=function(e){var t=n.props,a=t.record,l=t.handleSave;n.form.validateFields(function(t,n){t&&t[e.currentTarget.id]||l(c({},a,n))})},g(n,a)}return _(t,b.default.Component),p(t,[{key:"render",value:function(){var e=this,t=this.state.editing,a=this.props,n=a.editable,l=a.dataIndex,r=a.title,u=a.record,i=(a.index,a.handleSave,E(a,["editable","dataIndex","title","record","index","handleSave"]));return b.default.createElement("td",i,n?b.default.createElement(L.Consumer,null,function(a){return e.form=a,t?b.default.createElement(S,{style:{margin:0}},a.getFieldDecorator(l,{rules:[{required:!0,message:r+" is required."}],initialValue:u[l]})(b.default.createElement(d.default,{ref:function(t){return e.input=t},onPressEnter:e.save,onBlur:e.save}))):b.default.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:e.toggleEdit},i.children)}):i.children)}}]),t}(),k=function(e){function t(e){y(this,t);var a=g(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSaveClick=function(){var e={dbname:a.state.dbname,tableName:a.state.tableName,table_nlp1:a.state.table_nlp1,table_nlp2:a.state.table_nlp2,table_nlp3:a.state.table_nlp3,table_nlp4:a.state.table_nlp4,columnList:a.state.columnList};""!=a.state.dbname&&""!=a.state.tableName?m.default.post("reportServer/nlp/updateColumn",JSON.stringify(e)).then(function(e){"1000"==e.resultCode?(o.default.success("更新成功！"),window.location.href="#/query/NlpList"):o.default.error(e.message)}):alert("数据库与表名都不能为空")},a.handleSave=function(e){var t=[].concat(function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}(a.state.columnList)),n=t.findIndex(function(t){return e.key===t.key}),l=t[n];t.splice(n,1,c({},l,e)),a.setState({columnList:t})},a.state={tid:a.props.match.params.tid,dbList:[],dbname:"",tableData:[],tableName:"",table_nlp1:"",table_nlp2:"",table_nlp3:"",table_nlp4:""},a}return _(t,b.default.Component),p(t,[{key:"componentDidMount",value:function(){var e=this;if(x.getDbList().then(function(t){e.setState({dbList:t})}),null!=this.state.tid&&""!=this.state.tid){var t={table_id:this.state.tid};m.default.post("reportServer/nlp/getInfoByTableId",JSON.stringify(t)).then(function(t){e.setState({dbname:t.data.db.table_db,tableData:t.data.tableList,tableName:t.data.db.table_name,table_nlp1:t.data.db.table_nlp1,table_nlp2:t.data.db.table_nlp2,table_nlp3:t.data.db.table_nlp3,table_nlp4:t.data.db.table_nlp4});var a={dbname:t.data.db.table_db,tableName:t.data.db.table_name};m.default.post("reportServer/nlp/getColumnList",JSON.stringify(a)).then(function(t){"1000"==t.resultCode?(e.setState({columnList:t.data}),o.default.success("查询成功！")):o.default.error(t.message)})})}}},{key:"dbChange",value:function(e){var t=this;this.setState({dbname:e,columnList:[],tableData:[],tableName:"",table_nlp1:"",table_nlp2:"",table_nlp3:"",table_nlp4:""}),m.default.post("reportServer/nlp/getTable",e).then(function(e){"1000"==e.resultCode?(t.setState({tableData:e.data}),o.default.success("查询成功！")):o.default.error(e.message)})}},{key:"tableChange",value:function(e){var t=this;this.setState({tableName:e,columnList:[],table_nlp1:"",table_nlp2:"",table_nlp3:"",table_nlp4:""});var a={dbname:this.state.dbname,tableName:e};m.default.post("reportServer/nlp/getColumnList",JSON.stringify(a)).then(function(e){"1000"==e.resultCode?(t.setState({columnList:e.data}),o.default.success("查询成功！")):o.default.error(e.message)})}},{key:"onChangeV",value:function(e){var t,a,n,l=e.target.id,r=e.target.value;this.state[l]=r,this.setState((n=r,(a=l)in(t={})?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t))}},{key:"render",value:function(){var e=this,t={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};null!=this.state.columnList&&this.state.columnList.map(function(e,t){e.key=t});var a={body:{row:w,cell:N}},o=[{title:"字段名",dataIndex:"COLUMN_NAME",key:"COLUMN_NAME"},{title:"字段类型",dataIndex:"DATA_TYPE",key:"DATA_TYPE"},{title:"字段长度",dataIndex:"COLUMN_SIZE",key:"COLUMN_SIZE"},{title:"是否允许为空",dataIndex:"NULLABLE",key:"NULLABLE"},{title:"字段注释",dataIndex:"COMMENTS",key:"COMMENTS"},{title:"自然语言一",dataIndex:"FIELD_NLP1",key:"FIELD_NLP1",editable:!0},{title:"自然语言二",dataIndex:"FIELD_NLP2",key:"FIELD_NLP2",editable:!0},{title:"自然语言三",dataIndex:"FIELD_NLP3",key:"FIELD_NLP3",editable:!0},{title:"自然语言四",dataIndex:"FIELD_NLP4",key:"FIELD_NLP4",editable:!0},{title:"是否主键",dataIndex:"PRIMARY",key:"PRIMARY"}].map(function(t){return t.editable?c({},t,{onCell:function(a){return{record:a,editable:t.editable,dataIndex:t.dataIndex,title:t.title,handleSave:e.handleSave}}}):t});return b.default.createElement("div",{id:"page-wrapper",style:{background:"#ECECEC",padding:"0px"}},b.default.createElement(n.default,{title:"create"==this.state.action?"创建查询":"编辑查询",bordered:!1,bodyStyle:{padding:"5px"},headStyle:{height:"40px"},extra:b.default.createElement("div",null,b.default.createElement(i.default,{type:"primary",htmlType:"button",onClick:this.onSaveClick,style:{marginRight:"10px"}},"保存"),b.default.createElement(i.default,{icon:"list",onClick:function(){return window.location="#/query/QueryList"},style:{marginRight:"10px"}},"退出"))},b.default.createElement(r.default,null,b.default.createElement(u.default,{xs:24,sm:12},b.default.createElement(S,c({label:"选择数据库"},t,{style:{marginBottom:"5px"}}),b.default.createElement(s.default,{setValue:this.form,value:this.state.dbname,style:{minWidth:"300px"},onChange:function(t){return e.dbChange(t)}},null==this.state.dbList?null:this.state.dbList.map(function(e){return b.default.createElement(C,{key:e.name,value:e.name},e.name)}))))),b.default.createElement(r.default,null,b.default.createElement(u.default,{xs:24,sm:12},b.default.createElement(S,c({label:"表名"},t),b.default.createElement("div",null,b.default.createElement(s.default,{style:{minWidth:"300px"},id:"tableName",name:"tableName",value:this.state.tableName,onChange:function(t){return e.tableChange(t)}},null==this.state.tableData?null:this.state.tableData.map(function(e){return b.default.createElement(C,{key:e,value:e},e)})))))),""==this.state.tableName?null:b.default.createElement("div",null,b.default.createElement(r.default,null,b.default.createElement(u.default,{xs:24,sm:12},b.default.createElement(S,c({label:"自然语言一"},t),b.default.createElement(d.default,{style:{minWidth:"300px"},id:"table_nlp1",name:"table_nlp1",value:this.state.table_nlp1,onChange:function(t){return e.onChangeV(t)},placeholder:"请输入自然语言一"})," ")),b.default.createElement(u.default,{xs:24,sm:12},b.default.createElement(S,c({label:"自然语言二"},t),b.default.createElement(d.default,{style:{minWidth:"300px"},id:"table_nlp2",name:"table_nlp2",value:this.state.table_nlp2,onChange:function(t){return e.onChangeV(t)},placeholder:"请输入自然语言二"})))),b.default.createElement(r.default,null,b.default.createElement(u.default,{xs:24,sm:12},b.default.createElement(S,c({label:"自然语言三"},t),b.default.createElement(d.default,{style:{minWidth:"300px"},id:"table_nlp3",name:"table_nlp3",value:this.state.table_nlp3,onChange:function(t){return e.onChangeV(t)},placeholder:"请输入自然语言三"}))),b.default.createElement(u.default,{xs:24,sm:12},b.default.createElement(S,c({label:"自然语言四"},t),b.default.createElement(d.default,{style:{minWidth:"300px"},id:"table_nlp4",name:"table_nlp4",value:this.state.table_nlp4,onChange:function(t){return e.onChangeV(t)},placeholder:"请输入自然语言四"}))))),b.default.createElement(r.default,null,b.default.createElement(u.default,null,b.default.createElement(l.default,{ref:"diction",columns:o,components:a,rowClassName:function(){return"editable-row"},dataSource:this.state.columnList,size:"small",bordered:!0,pagination:!1})))))}}]),t}();t.default=k},1390:function(e,t,a){var n=a(1391);"string"==typeof n&&(n=[[e.i,n,""]]);var l={hmr:!0,transform:void 0};a(22)(n,l);n.locals&&(e.exports=n.locals)},1391:function(e,t,a){(e.exports=a(21)(!1)).push([e.i,".editable-cell {\n  position: relative; }\n\n.editable-cell-value-wrap {\n  padding: 5px 12px;\n  cursor: pointer; }\n\n.editable-row:hover .editable-cell-value-wrap {\n  border: 1px solid #d9d9d9;\n  border-radius: 4px;\n  padding: 4px 11px; }\n",""])}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1237:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(1)),o=n(444),i=c(n(1358)),u=c(n(1360)),s=c(n(1362)),l=c(n(1363));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"render",value:function(){return r.default.createElement(o.Switch,null,r.default.createElement(o.Route,{path:"/chat/questions/:qId",component:u.default}),r.default.createElement(o.Route,{path:"/chat/questionsList",component:i.default}),r.default.createElement(o.Route,{path:"/chat/answer/:aId/:qId",component:l.default}),r.default.createElement(o.Route,{path:"/chat/answerList/:qId",component:s.default}),r.default.createElement(o.Redirect,{exact:!0,from:"/chat",to:"/chat/questionsList"}))}}]),t}();t.default=f},1250:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1048);var r,o=n(442);var i=new((r=o)&&r.__esModule?r:{default:r}).default,u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"get",value:function(){}}],[{key:"getBaseUrl",value:function(){return window.getServerUrl()}},{key:"post",value:function(t,n){if(null==i.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t||""==i.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t)return window.location.href="#login",new Promise(function(e,t){});var a=e.getBaseUrl()+t,r={method:"POST",headers:{credentials:JSON.stringify(i.getStorage("userInfo")||"")},body:n};return fetch(a,r).then(function(e){return e.json()}).catch(function(e){return e.json()})}}]),e}();t.default=u},1267:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(1250),i=(a=o)&&a.__esModule?a:{default:a};var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"getQuestionList",value:function(e){return i.default.post("/reportServer/questions/getQuestionsList",JSON.stringify(e))}},{key:"getQuestionInfo",value:function(e){return i.default.post("/reportServer/questions/getQuestionsByID",e)}},{key:"saveQuestionInfo",value:function(e){return"null"==e.ai_question_id?i.default.post("/reportServer/questions/createQuestion",JSON.stringify(e)):i.default.post("/reportServer/questions/updateQuestion",JSON.stringify(e))}},{key:"deleteQuestion",value:function(e){return i.default.post("/reportServer/questions/deleteQuestion",e)}},{key:"getAnswerList",value:function(e,t){return i.default.post("/reportServer/questions/getAnswerListByqID/"+e,JSON.stringify(t))}},{key:"getAnswerId",value:function(e){return i.default.post("/reportServer/questions/getAnswerByID",e)}},{key:"saveAnswerInfo",value:function(e){return"null"==e.answer_id?i.default.post("/reportServer/questions/createAnswer",JSON.stringify(e)):i.default.post("/reportServer/questions/updateAnswer",JSON.stringify(e))}},{key:"deleteAnswer",value:function(e){return i.default.post("/reportServer/questions/deleteAnswer",e)}}]),e}();t.default=u},1283:function(e,t,n){var a=n(1359);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0};n(22)(a,r);a.locals&&(e.exports=a.locals)},1284:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1361);Object.defineProperty(t,"Recorder",{enumerable:!0,get:function(){return(e=a,e&&e.__esModule?e:{default:e}).default;var e}})},1358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(1042)),r=y(n(1047)),o=y(n(120)),i=y(n(44)),u=y(n(66)),s=y(n(1049)),l=y(n(1043)),c=y(n(1045)),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1041),n(1046),n(445),n(157),n(446),n(1050),n(443),n(1044);var d=y(n(1)),p=n(444),h=y(n(1267)),m=y(n(448)),v=y(n(442));function y(e){return e&&e.__esModule?e:{default:e}}n(1283);c.default.Item;var w=new v.default,g=new h.default,b=l.default.Search,_=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={list:[],pageNum:1,perPage:10,listType:"list",ai_question:""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d.default.Component),f(t,[{key:"componentDidMount",value:function(){this.loadQestionList()}},{key:"loadQestionList",value:function(){var e=this,t={};t.pageNum=this.state.pageNum,t.perPage=this.state.perPage,"search"===this.state.listType&&(t.ai_question=this.state.ai_question),g.getQuestionList(t).then(function(t){e.setState(t)},function(t){e.setState({list:[]})})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadQestionList()})}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n))}},{key:"onSearch",value:function(e){var t=this,n=""===e?"list":"search";this.setState({listType:n,pageNum:1,ai_question:e},function(){t.loadQestionList()})}},{key:"deleteQuestion",value:function(e){var t=this;confirm("删除问题时，对应的回答也全部删除。确认删除吗？")&&g.deleteQuestion(e).then(function(e){alert("删除成功"),t.loadQestionList()},function(e){alert("删除失败")})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=t});w.getStorage("userInfo");var t=this.state.list,n=[{title:"ID",dataIndex:"ai_question_id",key:"ai_question_id",className:"headerRow"},{title:"问题",dataIndex:"ai_question",key:"ai_question",className:"headerRow"},{title:"操作",dataIndex:"操作",className:"headerRow",render:function(t,n){return d.default.createElement("span",null,d.default.createElement(p.Link,{to:"/chat/Questions/"+n.ai_question_id},"编辑"),d.default.createElement(s.default,{type:"vertical"}),d.default.createElement("a",{onClick:function(){return e.deleteQuestion(""+n.ai_question_id)},href:"javascript:;"},"删除"),d.default.createElement(s.default,{type:"vertical"}),d.default.createElement(p.Link,{to:"/chat/AnswerList/"+n.ai_question_id},"设置回答"))}}];return d.default.createElement("div",{id:"page-wrapper"},d.default.createElement(a.default,{title:"问题列表"},d.default.createElement(o.default,null,d.default.createElement(u.default,{xs:24,sm:12},d.default.createElement(b,{style:{maxWidth:300,marginBottom:"10px"},placeholder:"请输入...",enterButton:"查询",onSearch:function(t){return e.onSearch(t)}})),d.default.createElement(u.default,{xs:24,sm:12},d.default.createElement(i.default,{href:"#/chat/Questions/null",style:{float:"right",marginRight:"30px"},type:"primary"},"新建问题"))),d.default.createElement(r.default,{dataSource:t,columns:n,pagination:!1}),d.default.createElement(m.default,{current:this.state.pageNum,total:this.state.totald,onChange:function(t){return e.onPageNumChange(t)}})))}}]),t}();t.default=_},1359:function(e,t,n){(e.exports=n(21)(!1)).push([e.i,".ant-table-thead .headerRow {\n  text-align: center; }\n\n.ant-table-tbody .headerRow {\n  text-align: center; }\n",""])},1360:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(1042)),r=y(n(44)),o=y(n(120)),i=y(n(66)),u=y(n(1043)),s=y(n(138)),l=y(n(1045)),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1041),n(157),n(445),n(446),n(443),n(447),n(1044);var d=y(n(1)),p=y(n(1267)),h=y(n(1250)),m=y(n(442)),v=n(1284);function y(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=new m.default,b=void 0,_=l.default.Item,k=new p.default;s.default.Option;function S(e){var t=document.querySelector("audio");t.autoplay=!0,t.src=e}window.onload=function(){try{window.AudioContext=window.AudioContext||window.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){var t=context.createMediaStreamSource(e),n=context.createBiquadFilter();t.connect(n),n.connect(context.destination)}),window.URL=window.URL||window.webkitURL,new AudioContext}catch(e){alert("No web audio support in this browser!")}};var E=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.startUserMedia=function(e){var t=(new AudioContext).createMediaStreamSource(e);b=new v.Recorder(t)},n.startRecording=function(){b&&b.record(),document.getElementById("start").disabled=!0,document.getElementById("stop").disabled=!1},n.stopRecording=function(){b&&b.stop(),n.createDownloadLink(),b.clear(),document.getElementById("start").disabled=!1,document.getElementById("stop").disabled=!0},n.createDownloadLink=function(){b&&b.exportWAV(function(e){console.log(1,e);var t=new FormData;if(t.append("file",e),h.default.post("reportServer/questions/saveQuestionAudio/"+n.state.ai_question_id,t).then(function(e){"1000"==e.resultCode&&(console.log(e.data),n.setState({ai_question_id:e.data}))}),!e)return console.log("无录音文件"),!1;S(URL.createObjectURL(e))})},n.state={confirmDirty:!1,ai_question_id:n.props.match.params.qId,ai_question:""},n.handleSubmit=n.handleSubmit.bind(n),n.handleConfirmBlur=n.handleConfirmBlur.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d.default.Component),f(t,[{key:"componentDidMount",value:function(){var e=this;null!=this.state.ai_question_id&&""!=this.state.ai_question_id&&"null"!=this.state.ai_question_id&&(k.getQuestionInfo(this.state.ai_question_id).then(function(t){e.setState(t.data),e.props.form.setFieldsValue({ai_question:t.data.ai_question,roai_question_idleId:t.data.ai_question_id,confirm:""})},function(t){e.setState({}),g.errorTips(t)}),this.getAudioBlob()),(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).call(navigator,{audio:!0},this.startUserMedia,function(e){console.log("No live audio input: "+e)}),document.getElementById("stop").disabled=!0}},{key:"getAudioBlob",value:function(){fetch(window.getServerUrl()+"reportServer/questions/getQuestionAduioBlob",{method:"POST",headers:{"Content-Type":"application/json",credentials:JSON.stringify(g.getStorage("userInfo")||"")},body:this.state.ai_question_id}).then(function(e){e.ok&&e.blob().then(function(e){e.size>0?S(window.URL.createObjectURL(e)):console.log("文件已丢失，请重新导出下载！")})})}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.setState(w({},t,n)),this.props.form.setFieldsValue(w({},t,n))}},{key:"onSelectChange",value:function(e,t){this.setState(w({},e,t)),this.props.form.setFieldsValue(w({},e,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,n){e||k.saveQuestionInfo(t.state).then(function(e){null!=t.state.ai_question_id&&""!=t.state.ai_question_id&&"null"!=t.state.ai_question_id?alert("修改成功"):alert("保存成功"),window.location.href="#chat/questionsList"},function(e){t.setState({}),g.errorTips(e)})})}},{key:"handleConfirmBlur",value:function(e){var t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return d.default.createElement("div",{id:"page-wrapper"},d.default.createElement(a.default,{title:"null"==this.state._id?"新建问题":"编辑问题"},d.default.createElement(l.default,{onSubmit:this.handleSubmit},d.default.createElement(o.default,null,d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement(_,c({},{labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},{label:"问题名称"}),t("ai_question",{rules:[{required:!0,message:"请输入问题名称!"}]})(d.default.createElement(u.default,{type:"text",name:"ai_question",onChange:function(t){return e.onValueChange(t)}}))))),d.default.createElement(o.default,null,d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement("audio",{controls:!0,autoplay:!0}),d.default.createElement(r.default,{type:"primary",onClick:this.startRecording,id:"start",inline:!0,size:"small"},"开始录音"),d.default.createElement(r.default,{type:"primary",onClick:this.stopRecording,id:"stop",style:{marginLeft:"5px"},size:"small"},"停止录音并保存"))),d.default.createElement(_,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},d.default.createElement(r.default,{type:"primary",htmlType:"submit"},"保存"),d.default.createElement(r.default,{href:"#/chat/questionsList",type:"primary",style:{marginLeft:"30px"}},"返回")))))}}]),t}();t.default=l.default.create()(E)},1361:function(e,t,n){"use strict";(function(n){var a,r,o,i,u,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};u=function(){return function e(t,n,a){function r(u,s){if(!n[u]){if(!t[u]){if(!s&&("function"==typeof i&&i))return i(u,!0);if(o)return o(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[u]={exports:{}};t[u][0].call(c.exports,function(e){var n=t[u][1][e];return r(n||e)},c,c.exports,e,t,n,a)}return n[u].exports}for(var o="function"==typeof i&&i,u=0;u<a.length;u++)r(a[u]);return r}({1:[function(e,t,n){t.exports=e("./recorder").Recorder},{"./recorder":2}],2:[function(e,t,n){var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();Object.defineProperty(n,"__esModule",{value:!0}),n.Recorder=void 0;var r,o=e("inline-worker"),i=(r=o)&&r.__esModule?r:{default:r};var u=n.Recorder=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={bufferLen:4096,sampleRate:8e3,numChannels:1,mimeType:"audio/wav"},this.recording=!1,this.callbacks={getBuffer:[],exportWAV:[]},Object.assign(this.config,n),this.context=t.context,this.node=(this.context.createScriptProcessor||this.context.createJavaScriptNode).call(this.context,this.config.bufferLen,this.config.numChannels,this.config.numChannels,this.config.sampleRate),this.node.onaudioprocess=function(e){if(a.recording){for(var t=[],n=0;n<a.config.numChannels;n++)t.push(e.inputBuffer.getChannelData(n));a.worker.postMessage({command:"record",buffer:t})}},t.connect(this.node),this.node.connect(this.context.destination);var r={};this.worker=new i.default(function(){var e=0,t=[],n=void 0;function a(){for(var e=0;e<n;e++)t[e]=[]}function o(e,t){for(var n=new Float32Array(t),a=0,r=0;r<e.length;r++)n.set(e[r],a),a+=e[r].length;return n}function i(e,t,n){for(var a=0;a<n.length;a++)e.setUint8(t+a,n.charCodeAt(a))}r.onmessage=function(u){switch(u.data.command){case"init":s=u.data.config,s.sampleRate,n=s.numChannels,a();break;case"record":!function(a){for(var r=0;r<n;r++)t[r].push(a[r]);e+=a[0].length}(u.data.buffer);break;case"exportWAV":!function(a){for(var u=[],s=0;s<n;s++)u.push(o(t[s],e));var l=void 0;if(l=function(e){for(var t=e.length/6,n=new Float32Array(t),a=0,r=0,o=0;r<t;)n[r]=e[o],o+=6,32768*n[r]>=4e3&&a++,r++;return console.log(a),n}(u[0])){var c=(d=l,p=new ArrayBuffer(44+2*d.length),i(h=new DataView(p),0,"RIFF"),h.setUint32(4,36+2*d.length,!0),i(h,8,"WAVE"),i(h,12,"fmt "),h.setUint32(16,16,!0),h.setUint16(20,1,!0),h.setUint16(22,n,!0),h.setUint32(24,8e3,!0),h.setUint32(28,32e3,!0),h.setUint16(32,2*n,!0),h.setUint16(34,16,!0),i(h,36,"data"),h.setUint32(40,2*d.length,!0),function(e,t,n){for(var a=0;a<n.length;a++,t+=2){var r=Math.max(-1,Math.min(1,n[a]));e.setInt16(t,r<0?32768*r:32767*r,!0)}}(h,44,d),h),f=new Blob([c],{type:a});r.postMessage({command:"exportWAV",data:f})}else r.postMessage({command:"exportWAV",data:!1});var d,p,h}(u.data.type);break;case"getBuffer":!function(){for(var a=[],i=0;i<n;i++)a.push(o(t[i],e));r.postMessage({command:"getBuffer",data:a})}();break;case"clear":e=0,t=[],a()}var s}},r),this.worker.postMessage({command:"init",config:{sampleRate:this.context.sampleRate,numChannels:this.config.numChannels}}),this.worker.onmessage=function(e){var t=a.callbacks[e.data.command].pop();"function"==typeof t&&t(e.data.data)}}return a(e,[{key:"record",value:function(){this.recording=!0}},{key:"stop",value:function(){this.recording=!1}},{key:"clear",value:function(){this.worker.postMessage({command:"clear"})}},{key:"getBuffer",value:function(e){if(!(e=e||this.config.callback))throw new Error("Callback not set");this.callbacks.getBuffer.push(e),this.worker.postMessage({command:"getBuffer"})}},{key:"exportWAV",value:function(e,t){if(t=t||this.config.mimeType,!(e=e||this.config.callback))throw new Error("Callback not set");this.callbacks.exportWAV.push(e),this.worker.postMessage({command:"exportWAV",type:t})}}],[{key:"forceDownload",value:function(e,t){var n=(window.URL||window.webkitURL).createObjectURL(e),a=window.document.createElement("a");a.href=n,a.download=t||"output.wav";var r=document.createEvent("Event");r.initEvent("click",!0,!0),a.dispatchEvent(r)}}]),e}();n.default=u},{"inline-worker":3}],3:[function(e,t,n){t.exports=e("./inline-worker")},{"./inline-worker":4}],4:[function(e,t,a){(function(e){var n=function(){function e(e,t){for(var n in t){var a=t[n];a.configurable=!0,a.value&&(a.writable=!0)}Object.defineProperties(e,t)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),a=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=!!(e===e.window&&e.URL&&e.Blob&&e.Worker),o=function(){function t(n,o){var i=this;if(a(this,t),r){var u=n.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1],s=e.URL.createObjectURL(new e.Blob([u],{type:"text/javascript"}));return new e.Worker(s)}this.self=o,this.self.postMessage=function(e){setTimeout(function(){i.onmessage({data:e})},0)},setTimeout(function(){n.call(o)},0)}return n(t,{postMessage:{value:function(e){var t=this;setTimeout(function(){t.self.onmessage({data:e})},0)}}}),t}();t.exports=o}).call(this,void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)},"object"===s(t)&&void 0!==e?e.exports=u():(r=[],void 0===(o="function"==typeof(a=u)?a.apply(t,r):a)||(e.exports=o))}).call(this,n(83))},1362:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(1042)),r=y(n(1047)),o=y(n(120)),i=y(n(66)),u=y(n(44)),s=y(n(1049)),l=y(n(1043)),c=y(n(1045)),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1041),n(1046),n(445),n(446),n(157),n(1050),n(443),n(1044);var d=y(n(1)),p=n(444),h=y(n(1267)),m=y(n(448)),v=y(n(442));function y(e){return e&&e.__esModule?e:{default:e}}n(1283);c.default.Item,new v.default;var w=new h.default,g=l.default.Search,b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={list:[],pageNum:1,perPage:10,listType:"list",answer:"",question_id:n.props.match.params.qId},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d.default.Component),f(t,[{key:"componentDidMount",value:function(){this.loadAnswerList()}},{key:"loadAnswerList",value:function(){var e=this,t={};t.question_id=this.state.question_id,t.pageNum=this.state.pageNum,t.perPage=this.state.perPage,"search"===this.state.listType&&(t.answer=this.state.answer),w.getAnswerList(this.state.question_id,t).then(function(t){e.setState(t)},function(t){e.setState({list:[]})})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadAnswerList()})}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,n))}},{key:"onSearch",value:function(e){var t=this,n=""===e?"list":"search";this.setState({listType:n,pageNum:1,answer:e},function(){t.loadAnswerList()})}},{key:"deleteAnswer",value:function(e){var t=this;confirm("确认删除吗？")&&w.deleteAnswer(e).then(function(e){alert("删除成功"),t.loadAnswerList()},function(e){alert("删除失败")})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=t});var t=this.state.list,n=[{title:"ID",dataIndex:"answer_id",key:"answer_id",className:"headerRow"},{title:"回答",dataIndex:"answer",key:"answer",className:"headerRow"},,{title:"是否默认",dataIndex:"current",key:"current",className:"headerRow"},{title:"操作",dataIndex:"操作",className:"headerRow",render:function(t,n){return d.default.createElement("span",null,d.default.createElement(p.Link,{to:"/chat/answer/"+n.answer_id+"/"+n.question_id},"编辑"),d.default.createElement(s.default,{type:"vertical"}),d.default.createElement("a",{onClick:function(){return e.deleteAnswer(""+n.answer_id)},href:"javascript:;"},"删除"))}}];return d.default.createElement("div",{id:"page-wrapper"},d.default.createElement(a.default,{title:"回答列表",extra:d.default.createElement(u.default,{href:"#/chat/QuestionsList",type:"primary"},"返回问题列表")},d.default.createElement(o.default,null,d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement(g,{style:{maxWidth:300,marginBottom:"10px"},placeholder:"请输入...",enterButton:"查询",onSearch:function(t){return e.onSearch(t)}})),d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement(u.default,{href:"#/chat/answer/null/"+this.state.question_id,style:{float:"right",marginRight:"30px"},type:"primary"},"新建问题"))),d.default.createElement(r.default,{dataSource:t,columns:n,pagination:!1}),d.default.createElement(m.default,{current:this.state.pageNum,total:this.state.totald,onChange:function(t){return e.onPageNumChange(t)}})))}}]),t}();t.default=b},1363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(1042)),r=y(n(44)),o=y(n(120)),i=y(n(66)),u=y(n(1043)),s=y(n(138)),l=y(n(1045)),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(1041),n(157),n(445),n(446),n(443),n(447),n(1044);var d=y(n(1)),p=y(n(1267)),h=y(n(1250)),m=y(n(442)),v=n(1284);function y(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=new m.default,b=void 0,_=l.default.Item,k=new p.default,S=s.default.Option;function E(e){var t=document.querySelector("audio");t.autoplay=!0,t.src=e}window.onload=function(){try{window.AudioContext=window.AudioContext||window.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia,window.URL=window.URL||window.webkitURL,new AudioContext}catch(e){alert("No web audio support in this browser!")}};var O=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.startUserMedia=function(e){var t=(new AudioContext).createMediaStreamSource(e);b=new v.Recorder(t)},n.startRecording=function(){b&&b.record(),document.getElementById("start").disabled=!0,document.getElementById("stop").disabled=!1},n.stopRecording=function(){b&&b.stop(),n.createDownloadLink(),b.clear(),document.getElementById("start").disabled=!1,document.getElementById("stop").disabled=!0},n.createDownloadLink=function(){b&&b.exportWAV(function(e){console.log(1,e);var t=new FormData;if(t.append("file",e),h.default.post("reportServer/questions/saveAnswerAudio/"+n.state.answer_id+"/"+n.state.question_id,t).then(function(e){"1000"==e.resultCode&&(console.log(e.data),n.setState({answer_id:e.data}))}),!e)return console.log("无录音文件"),!1;E(URL.createObjectURL(e))})},n.state={confirmDirty:!1,answer_id:n.props.match.params.aId,question_id:n.props.match.params.qId,current:"",answer:"",creat_by:g.getStorage("userInfo").userId},n.handleSubmit=n.handleSubmit.bind(n),n.handleConfirmBlur=n.handleConfirmBlur.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,d.default.Component),f(t,[{key:"componentDidMount",value:function(){var e=this;null!=this.state.answer_id&&""!=this.state.answer_id&&"null"!=this.state.answer_id&&(k.getAnswerId(this.state.answer_id).then(function(t){e.setState(t.data),e.props.form.setFieldsValue({answer_id:t.data.answer_id,question_id:t.data.question_id,current:t.data.current,answer:t.data.answer,creat_by:t.data.creat_by,confirm:""})},function(t){e.setState({}),g.errorTips(t)}),this.getAudioBlob()),(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).call(navigator,{audio:!0},this.startUserMedia,function(e){console.log("No live audio input: "+e)}),document.getElementById("stop").disabled=!0}},{key:"getAudioBlob",value:function(){fetch(window.getServerUrl()+"reportServer/questions/getAnswerAduioBlob",{method:"POST",headers:{"Content-Type":"application/json",credentials:JSON.stringify(g.getStorage("userInfo")||"")},body:this.state.answer_id}).then(function(e){e.ok&&e.blob().then(function(e){e.size>0?E(window.URL.createObjectURL(e)):console.log("文件已丢失，请重新导出下载！")})})}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.setState(w({},t,n)),this.props.form.setFieldsValue(w({},t,n))}},{key:"onSelectChange",value:function(e,t){this.setState(w({},e,t)),this.props.form.setFieldsValue(w({},e,t))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFieldsAndScroll(function(e,n){e||k.saveAnswerInfo(t.state).then(function(e){null!=t.state.answer_id&&""!=t.state.answer_id&&"null"!=t.state.answer_id?alert("修改成功"):alert("保存成功"),window.location.href="#chat/answerList/"+t.state.question_id},function(e){t.setState({}),g.errorTips(e)})})}},{key:"handleConfirmBlur",value:function(e){var t=e.target.value;this.setState({confirmDirty:this.state.confirmDirty||!!t})}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,n={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}};return d.default.createElement("div",{id:"page-wrapper"},d.default.createElement(a.default,{title:"null"==this.state._id?"新建回答":"编辑回答"},d.default.createElement(l.default,{onSubmit:this.handleSubmit},d.default.createElement(o.default,null,d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement(_,c({},n,{label:"回答"}),t("answer",{rules:[{required:!0,message:"请输入回答!"}]})(d.default.createElement(u.default,{type:"text",name:"answer",onChange:function(t){return e.onValueChange(t)}})))),d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement(_,c({},n,{label:"是否默认"}),d.default.createElement(s.default,{name:"current",value:this.state.current.toString(),style:{width:120},onChange:function(t){return e.onSelectChange("current",t)}},d.default.createElement(S,{value:"1"},"是"),d.default.createElement(S,{value:"0"},"否"))))),d.default.createElement(o.default,null,d.default.createElement(i.default,{xs:24,sm:12},d.default.createElement("audio",{controls:!0,autoplay:!0}),d.default.createElement(r.default,{type:"primary",onClick:this.startRecording,id:"start",inline:!0,size:"small"},"开始录音"),d.default.createElement(r.default,{type:"primary",onClick:this.stopRecording,id:"stop",style:{marginLeft:"5px"},size:"small"},"停止录音并保存"))),d.default.createElement(_,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},d.default.createElement(r.default,{type:"primary",htmlType:"submit"},"保存"),d.default.createElement(r.default,{href:"#/chat/answerList/"+this.state.question_id,type:"primary",style:{marginLeft:"30px"}},"返回")))))}}]),t}();t.default=l.default.create()(O)}}]);
webpackJsonp([34],{1661:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}Object.defineProperty(t,"__esModule",{value:!0});var c=n(460),f=a(c),d=n(479),p=a(d),m=n(491),v=a(m),y=n(556),h=a(y),g=n(507),C=a(g),b=n(1351),k=a(b),E=n(463),_=a(E),w=n(482),x=a(w),O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},P=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(461),n(481),n(506),n(557),n(508),n(1352),n(444),n(483);var j=n(10),F=a(j),I=(n(150),n(785)),S=a(I),N=n(540),A=(a(N),n(151)),K=a(A);n(1353);var L=x.default.Item,T=_.default.Search,R=(new K.default,new S.default),D=F.default.createContext(),M=function(e){var t=e.form,n=(e.index,s(e,["form","index"]));return F.default.createElement(D.Provider,{value:t},F.default.createElement("tr",n))},V=x.default.create()(M),B=function(e){function t(){var e,n,a,r;l(this,t);for(var i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=a=u(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),a.getInput=function(){return F.default.createElement(_.default,null)},r=n,u(a,r)}return o(t,e),P(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.editing,a=t.dataIndex,r=t.title,i=(t.inputType,t.record),l=(t.index,s(t,["editing","dataIndex","title","inputType","record","index"]));return F.default.createElement(D.Consumer,null,function(t){var u=t.getFieldDecorator;return F.default.createElement("td",l,n?F.default.createElement(L,{style:{margin:0}},u(a,{rules:[{required:!0,message:"Please Input "+r+"!"}],initialValue:i[a]})(e.getInput())):l.children)})}}]),t}(F.default.Component),q=function(e){function t(e){l(this,t);var n=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.isEditing=function(e){return e.key===n.state.editingKey},n.cancel=function(){n.setState({editingKey:""})},n.state={list:[],pageNum:1,perPage:10,listType:"list",className:"",editingKey:""},n.columns=[{title:"ID",dataIndex:"class_id",key:"class_id",className:"headerRow"},{title:"类别名称",dataIndex:"class_name",key:"class_name",className:"headerRow",editable:!0},{title:"操作",dataIndex:"操作",className:"headerRow",render:function(e,t){var a=n.isEditing(t);return F.default.createElement("div",null,a?F.default.createElement("span",null,F.default.createElement(D.Consumer,null,function(e){return F.default.createElement("a",{href:"javascript:;",onClick:function(){return n.save(e,t.key)},style:{marginRight:8}},"保存")}),F.default.createElement(k.default,{title:"确定取消吗?",onConfirm:function(){return n.cancel(t.key)}},F.default.createElement("a",null,"取消"))):F.default.createElement("div",null,F.default.createElement("a",{onClick:function(){return n.edit(t.key)}},"编辑"),F.default.createElement(C.default,{type:"vertical"}),F.default.createElement("a",{onClick:function(){return n.deleteFunctionClss(""+t.key)},href:"javascript:;"},"删除")))}}],n}return o(t,e),P(t,[{key:"componentDidMount",value:function(){this.loadFunctionClassList()}},{key:"loadFunctionClassList",value:function(){var e=this,t={};t.pageNum=this.state.pageNum,t.perPage=this.state.perPage,R.getAllFunctionClass(t).then(function(t){e.setState({list:t.data})},function(t){e.setState({list:[]})})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadFunctionClassList()})}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.setState(i({},t,n))}},{key:"deleteFunctionClss",value:function(e){var t=this;if(confirm("确认删除吗？")){var n={class_id:e};R.deleteFunctionClss(n).then(function(e){h.default.success("删除成功"),t.loadFunctionClassList()},function(e){h.default.error("删除失败")})}}},{key:"saveClick",value:function(e){var t=this;if(""!=e&&null!=e){var n={class_name:e};R.saveFunctionClass(n).then(function(e){"1000"==e.resultCode&&(h.default.success("保存成功"),t.setState({className:""})),t.loadFunctionClassList()})}}},{key:"onValueChange",value:function(e){var t=e.target.name,n=e.target.value.trim();this.setState(i({},t,n))}},{key:"edit",value:function(e){this.setState({editingKey:e})}},{key:"save",value:function(e,t){var n=this;e.validateFields(function(e,a){if(!e){var i=[].concat(r(n.state.list)),l=i.findIndex(function(e){return t===e.key});if(l>-1){var u=i[l],o=a;o.class_id=t,R.updateFunctionClass(o).then(function(e){"1000"==e.resultCode?(i.splice(l,1,O({},u,a)),n.setState({list:i,editingKey:""})):(h.default.error("保存失败"),n.loadFunctionClassList())})}else i.push(a),n.setState({list:i,editingKey:""})}})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=e.class_id});var t={body:{row:V,cell:B}},n=this.columns.map(function(t){return t.editable?O({},t,{onCell:function(n){return{record:n,inputType:"text"===t.dataIndex,dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(n)}}}):t});return F.default.createElement("div",{id:"page-wrapper"},F.default.createElement(f.default,{title:"类别管理"},F.default.createElement(v.default,null,F.default.createElement(T,{placeholder:"输入新类别名称",enterButton:"新建类别",size:"large",style:{width:300,marginBottom:"10px"},name:"className",onSearch:function(t){return e.saveClick(t)}})),F.default.createElement(p.default,{dataSource:this.state.list,columns:n,pagination:!1,components:t,rowClassName:"editable-row"})))}}]),t}(F.default.Component);t.default=q}});
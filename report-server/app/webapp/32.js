(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1250:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r(1048);var a,u=r(442);var l=new((a=u)&&a.__esModule?a:{default:a}).default,i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"get",value:function(){}}],[{key:"getBaseUrl",value:function(){return window.getServerUrl()}},{key:"post",value:function(t,r){if(null==l.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t||""==l.getStorage("userInfo")&&"/reportServer/user/encodePwd"!=t&&"/reportServer/user/Reactlogin"!=t)return window.location.href="#login",new Promise(function(e,t){});var n=e.getBaseUrl()+t,a={method:"POST",headers:{credentials:JSON.stringify(l.getStorage("userInfo")||"")},body:r};return fetch(n,a).then(function(e){return e.json()}).catch(function(e){return e.json()})}}]),e}();t.default=i},1253:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1250),l=(n=u)&&n.__esModule?n:{default:n};var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"getCategoryList",value:function(){return l.default.post("reportServer/select/getSelectClass",{})}},{key:"getSelectClassTree",value:function(){return l.default.post("reportServer/select/getSelectClassTree",{})}},{key:"getQueryClassTree",value:function(e){var t={userId:e};return l.default.post("reportServer/auth/getMenuListNew",JSON.stringify(t))}},{key:"getMyReports",value:function(){return l.default.post("reportServer/web/getDirectory",null)}},{key:"MyReportUrl",value:function(){return l.default.post("reportServer/web/MyReportUrl",null)}},{key:"getReportNameList",value:function(e){var t="reportServer/select/getSelectName/"+e;return l.default.post(t,{})}},{key:"getQueryCriteria",value:function(e){var t="reportServer/query/getQueryParam/"+e;return l.default.post(t,{})}},{key:"execSelect",value:function(e,t,r){var n="reportServer/query/execQuery/"+t+"/"+e;return l.default.post(n,JSON.stringify(r))}},{key:"getDictionaryList",value:function(e,t){var r="reportServer/dict/getDictValueByID/"+e;return l.default.post(r,JSON.stringify(t))}},{key:"getAllQueryClass",value:function(){return l.default.post("reportServer/query/getAllQueryClass","")}},{key:"saveQueryClass",value:function(e){return l.default.post("reportServer/query/createQueryClassInfo",JSON.stringify(e))}},{key:"updateQueryClass",value:function(e){return l.default.post("reportServer/query/updateQueryClassInfo",JSON.stringify(e))}},{key:"deleteQueryClass",value:function(e){return l.default.post("reportServer/query/deleteQueryClassInfo",JSON.stringify(e))}},{key:"selectLinkValue",value:function(e,t){var r="reportServer/query/getQueryOutLink/"+e+"/"+t;return l.default.post(r,{})}},{key:"getQueryClassTreetwo",value:function(e){var t={userId:e};return l.default.post("reportServer/auth/getClassId",JSON.stringify(t))}},{key:"getQryNameByClassId",value:function(e){return l.default.post("reportServer/auth/getQryNameByClassId",JSON.stringify(e))}},{key:"getAllQueryNameList",value:function(e){return l.default.post("reportServer/query/getAllQueryNameList",JSON.stringify(e))}},{key:"getCubeListInAuth",value:function(e){var t={userId:e};return l.default.post("reportServer/auth/getCubeListInAuth",JSON.stringify(t))}},{key:"getDashboardListInAuth",value:function(e){var t={userId:e};return l.default.post("reportServer/auth/getDashboardListInAuth",JSON.stringify(t))}}]),e}();t.default=i},1385:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=C(r(1183)),a=C(r(1185)),u=C(r(1042)),l=C(r(1047)),i=C(r(90)),o=C(r(1053)),s=C(r(1186)),c=C(r(1049)),f=C(r(1205)),d=C(r(1043)),y=C(r(1045)),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r(1182),r(1184),r(1041),r(1046),r(289),r(1052),r(1187),r(1050),r(1206),r(443),r(1044);var g=C(r(1)),m=(r(444),C(r(1253))),h=C(r(448)),S=C(r(442)),k=C(r(1250));function C(e){return e&&e.__esModule?e:{default:e}}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function O(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function N(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var I=y.default.Item,_=d.default.Search,Q=(new S.default,new m.default),P=window.getServerUrl(),L=g.default.createContext(),j=y.default.create()(function(e){var t=e.form,r=(e.index,N(e,["form","index"]));return g.default.createElement(L.Provider,{value:t},g.default.createElement("tr",r))}),x=function(e){function t(){var e,r,n;w(this,t);for(var a=arguments.length,u=Array(a),l=0;l<a;l++)u[l]=arguments[l];return r=n=E(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.getInput=function(){return g.default.createElement(d.default,null)},E(n,r)}return O(t,g.default.Component),v(t,[{key:"render",value:function(){var e=this.props,t=e.editing,r=e.dataIndex,n=e.title,a=(e.inputType,e.record),u=(e.index,N(e,["editing","dataIndex","title","inputType","record","index"]));return g.default.createElement(L.Consumer,null,function(e){var l=e.getFieldDecorator;return g.default.createElement("td",u,t?g.default.createElement(I,{style:{margin:0}},l(r,{rules:[{required:!0,message:"Please Input "+n+"!"}],initialValue:a[r]})(g.default.createElement(d.default,null))):u.children)})}}]),t}(),J=function(e){function t(e){w(this,t);var r=E(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isEditing=function(e){return e.key===r.state.editingKey},r.cancel=function(){r.setState({editingKey:""})},r.openImage=function(e){r.setState({visible:!0,imgList:[],totald:0,actityKeys:e},function(){this.loadModelData()})},r.handleCancel=function(e){r.setState({visible:!1})},r.handleOk=function(e){r.setState({visible:!1})},r.state={list:[],pageNum:1,perPage:10,listType:"list",className:"",editingKey:"",actityKeys:""},r.columns=[{title:"ID",dataIndex:"class_id",key:"class_id",className:"headerRow"},{title:"类别名称",dataIndex:"class_name",key:"class_name",className:"headerRow",editable:!0},{title:"操作",dataIndex:"操作",className:"headerRow",render:function(e,t){var n=r.isEditing(t);return g.default.createElement("div",null,n?g.default.createElement("span",null,g.default.createElement(L.Consumer,null,function(e){return g.default.createElement("a",{href:"javascript:;",onClick:function(){return r.save(e,t.key)},style:{marginRight:8}},"保存")}),g.default.createElement(f.default,{title:"确定取消吗?",onConfirm:function(){return r.cancel(t.key)}},g.default.createElement("a",null,"取消"))):g.default.createElement("div",null,g.default.createElement("a",{onClick:function(){return r.edit(t.key)}},"编辑"),g.default.createElement(c.default,{type:"vertical"}),g.default.createElement("a",{onClick:function(){return r.deleteQueryClss(""+t.key)},href:"javascript:;"},"删除"),g.default.createElement(c.default,{type:"vertical"}),g.default.createElement("a",{onClick:function(){return r.openImage(t.key)}},"上传图片"),g.default.createElement(c.default,{type:"vertical"}),null==t.img_file?"":g.default.createElement(s.default,{src:P+"/report/"+t.img_file})))}}],r}return O(t,g.default.Component),v(t,[{key:"clickImg",value:function(e){}},{key:"componentDidMount",value:function(){this.loadQueryClassList()}},{key:"loadQueryClassList",value:function(){var e=this,t={};t.pageNum=this.state.pageNum,t.perPage=this.state.perPage,Q.getAllQueryClass(t).then(function(t){e.setState({list:t.data})},function(t){e.setState({list:[]})})}},{key:"onPageNumChange",value:function(e){var t=this;this.setState({pageNum:e},function(){t.loadQueryClassList()})}},{key:"onValueChange",value:function(e){var t=e.target.name,r=e.target.value.trim();this.setState(b({},t,r))}},{key:"deleteQueryClss",value:function(e){var t=this;if(confirm("确认删除吗？")){var r={class_id:e};Q.deleteQueryClass(r).then(function(e){o.default.success("删除成功"),t.loadQueryClassList()},function(e){o.default.error("删除失败")})}}},{key:"saveClick",value:function(e){var t=this;if(""!=e&&null!=e){var r={class_name:e};Q.saveQueryClass(r).then(function(e){"1000"==e.resultCode&&(o.default.success("保存成功"),t.setState({className:""})),t.loadQueryClassList()})}}},{key:"onValueChange",value:function(e){var t=e.target.name,r=e.target.value.trim();this.setState(b({},t,r))}},{key:"edit",value:function(e){this.setState({editingKey:e})}},{key:"save",value:function(e,t){var r=this;e.validateFields(function(e,n){if(!e){var a=[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r.state.list)),u=a.findIndex(function(e){return t===e.key});if(u>-1){var l=a[u],i=n;i.class_id=t,Q.updateQueryClass(i).then(function(e){"1000"==e.resultCode?(a.splice(u,1,p({},l,n)),r.setState({list:a,editingKey:""})):(o.default.error("保存失败"),r.loadQueryClassList())})}else a.push(n),r.setState({list:a,editingKey:""})}})}},{key:"loadModelData",value:function(){var e=this,t={};t.pageNum=this.state.pageNumd,t.perPage=this.state.perPaged,k.default.post("/reportServer/uploadFile/getAll",JSON.stringify(t)).then(function(t){e.setState({imgList:t.data.list,totald:t.data.total})},function(t){e.setState({imgList:[]})})}},{key:"onPageNumdChange",value:function(e){var t=this;this.setState({pageNumd:e},function(){t.loadModelData()})}},{key:"clickimg",value:function(e,t){var r=this,n={calssid:this.state.actityKeys,img_file:e};k.default.post("/reportServer/query/uploadImg",JSON.stringify(n)).then(function(e){r.loadQueryClassList()},function(e){r.setState({imgList:[]})}),this.setState({visible:!1})}},{key:"render",value:function(){var e=this;this.state.list.map(function(e,t){e.key=e.class_id});var t={body:{row:j,cell:x}},r=this.columns.map(function(t){return t.editable?p({},t,{onCell:function(r){return{record:r,inputType:"text"===t.dataIndex,dataIndex:t.dataIndex,title:t.title,editing:e.isEditing(r)}}}):t});return g.default.createElement("div",{id:"page-wrapper"},g.default.createElement(u.default,{title:"查询管理"},g.default.createElement(i.default,null,g.default.createElement(_,{placeholder:"输入新查询名称",enterButton:"新建查询",size:"large",style:{width:300,marginBottom:"10px"},name:"className",onSearch:function(t){return e.saveClick(t)}})),g.default.createElement(l.default,{dataSource:this.state.list,columns:r,pagination:!1,components:t,rowClassName:"editable-row"})),g.default.createElement("div",null,g.default.createElement(n.default,{title:"图片选择",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel},g.default.createElement(a.default,{itemLayout:"horizontal",dataSource:this.state.imgList,renderItem:function(t){return g.default.createElement(a.default.Item,null,g.default.createElement(a.default.Item.Meta,{avatar:g.default.createElement(s.default,{src:P+"/report/"+t.usefilepath}),description:g.default.createElement("a",{onClick:function(){return e.clickimg(t.usefilepath,t.filename)}},t.filename)}))}}),g.default.createElement(h.default,{current:this.state.pageNumd,total:this.state.totald,onChange:function(t){return e.onPageNumdChange(t)}}))))}}]),t}();t.default=J}}]);